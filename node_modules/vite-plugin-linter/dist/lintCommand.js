#!/usr/bin/env node
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const vite_1 = require("vite");
const linterPluginBuild_1 = require("./linterPluginBuild");
async function lint() {
    const config = await (0, vite_1.resolveConfig)({}, "build");
    const plugin = config.plugins.find((p) => p.name === linterPluginBuild_1.buildPluginName);
    if (!plugin) {
        throw new Error(`Could not find plugin ${linterPluginBuild_1.buildPluginName}`);
    }
    const outputLines = await plugin.lintFolder(process.cwd());
    if (outputLines.length > 0) {
        for (const output of outputLines) {
            console.warn(output);
        }
        console.error("Linting failed, see above output");
        process.exit(1);
    }
}
global.vitePluginLinter = { mode: "lintCommand" };
lint();
